{"version":3,"sources":["../../src/client/WesttownRenderer.js"],"names":["game","client","clientPlayer","WesttownRenderer","gameEngine","clientEngine","document","readyState","onDOMLoaded","addEventListener","bind","Promise","resolve","reject","emit","console","log","mapImg","createElement","id","src","style","width","MAPS","height","position","getElementById","appendChild","sendInput","e","allowedChars","includes","key","isReady","obj","newPlayer","playerId","className","playerRadius","top","screenHeight","left","screenWidth","marginLeft","marginTop","background","color","backgroundImage","costume","playerEmote","el","remove","newFlag","flagRadius","borderRadius","innerText","newWordBlock","wordBlockRadius","character","newMegaphone","megaphoneRadius","megaphoneScreen","megaphoneInput","type","placeholder","maxLength","megaphoneButton","value","t","dt","world","queryObject","instanceType","Player","forEachObject","updateClientPlayer","emote","getElementsByClassName","updateOtherObject","Flag","WordBlock","Megaphone","distance","display","isBroadcasting","message","map","room","x","y","clientEl","clientObj","parseInt","slice","Renderer"],"mappings":"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","sourcesContent":["import {Renderer} from 'lance-gg';\r\nimport Player from './../common/Player';\r\nimport Flag from './../common/Flag';\r\nimport {MAPS} from './../common/Maps';\r\nimport WordBlock from '../common/WordBlock';\r\nimport Megaphone from '../common/Megaphone';\r\n\r\nlet game = null;\r\nlet client = null;\r\nlet clientPlayer = null;\r\n\r\nexport default class WesttownRenderer extends Renderer {\r\n\r\n    constructor(gameEngine, clientEngine) {\r\n        super(gameEngine, clientEngine);\r\n        game = gameEngine;\r\n        client = clientEngine;\r\n    }\r\n\r\n    init() {\r\n        if (document.readyState === 'complete' || document.readyState === 'loaded' || document.readyState === 'interactive')\r\n            this.onDOMLoaded();\r\n        else\r\n            document.addEventListener('DOMContentLoaded', this.onDOMLoaded.bind(this));\r\n\r\n        return new Promise((resolve, reject) => {\r\n            game.emit('renderer.ready');\r\n            resolve();\r\n            console.log(\"promise resolved\");\r\n        });\r\n    }\r\n\r\n    onDOMLoaded() {\r\n        console.log(\"DOM loaded\");\r\n        let mapImg = document.createElement(\"img\");\r\n        mapImg.id = \"map\";\r\n        mapImg.src = \"./lobby.png\";\r\n        mapImg.style.width = MAPS['/lobby'].width + \"px\";\r\n        mapImg.style.height = MAPS['/lobby'].height + \"px\";\r\n        mapImg.style.position = \"absolute\";\r\n\r\n        document.getElementById(\"game\").appendChild(mapImg);\r\n\r\n        document.getElementById(\"button-1\").addEventListener(\"click\", () => {\r\n            client.sendInput(\"heart\");\r\n        });\r\n        document.getElementById(\"button-2\").addEventListener(\"click\", () => {\r\n            client.sendInput(\"smile\");\r\n        });\r\n        document.getElementById(\"button-3\").addEventListener(\"click\", () => {\r\n            client.sendInput(\"frown\");\r\n        });\r\n\r\n        document.addEventListener(\"keydown\", (e) => {\r\n            var allowedChars = \"abcdefghijklmnopqrstuvwxyz1234567890\";\r\n            if (allowedChars.includes(e.key)) client.sendInput(e.key);\r\n        });\r\n\r\n        this.isReady = true;\r\n\r\n    }\r\n\r\n    addPlayer(obj) {\r\n        let newPlayer = document.createElement(\"div\");\r\n        newPlayer.id = obj.id + \"_\" + obj.playerId;\r\n        newPlayer.className = \"player\";\r\n        newPlayer.style.height = game.playerRadius + \"px\";\r\n        newPlayer.style.width = game.playerRadius + \"px\";\r\n        newPlayer.style.position = \"absolute\";\r\n        newPlayer.style.top = game.screenHeight/2 + \"px\";\r\n        newPlayer.style.left = game.screenWidth/2 + \"px\";\r\n        newPlayer.style.marginLeft = -game.playerRadius/2 + \"px\";\r\n        newPlayer.style.marginTop = -game.playerRadius/2 + \"px\";\r\n       // newPlayer.style.zIndex = 5;\r\n        newPlayer.style.background = obj.color;\r\n        newPlayer.style.backgroundImage = \"url('costumes/costume\" + obj.costume + \".png')\";\r\n\r\n        let playerEmote = document.createElement(\"h4\");\r\n        playerEmote.className = \"emote\";\r\n        playerEmote.style.color = \"white\";\r\n        playerEmote.style.marginLeft = -game.playerRadius/2 + \"px\";\r\n        playerEmote.style.marginTop = -2.5*game.playerRadius + \"px\";\r\n\r\n        newPlayer.appendChild(playerEmote);\r\n\r\n        document.getElementById(\"game\").appendChild(newPlayer);\r\n        \r\n    }\r\n\r\n    removePlayer(obj) {\r\n        let el = document.getElementById(obj.id + \"_\" + obj.playerId);\r\n        if (el) el.remove();\r\n    }\r\n\r\n    addFlag(obj) {\r\n        let newFlag = document.createElement(\"div\");\r\n        newFlag.id = obj.id;\r\n        newFlag.className = \"flag\";\r\n        newFlag.style.height = game.flagRadius + \"px\";\r\n        newFlag.style.width = game.flagRadius + \"px\";\r\n        newFlag.style.borderRadius = \"50%\";\r\n        newFlag.style.background = obj.color;\r\n        newFlag.style.position = \"absolute\";\r\n        newFlag.style.marginLeft = -game.flagRadius/2 + \"px\";\r\n        newFlag.style.marginTop = -game.flagRadius/2 + \"px\";\r\n\r\n        newFlag.innerText = \"🚩\";\r\n\r\n        document.getElementById(\"game\").appendChild(newFlag);\r\n\r\n    }\r\n\r\n    removeObject(obj) {\r\n        let el = document.getElementById(obj.id);\r\n        if (el) el.remove();\r\n    }\r\n\r\n    addWordBlock(obj) {\r\n        let newWordBlock = document.createElement(\"div\");\r\n        newWordBlock.id = obj.id;\r\n        newWordBlock.className = \"wordBlock\";\r\n        newWordBlock.style.height = game.wordBlockRadius + \"px\";\r\n        newWordBlock.style.width = game.wordBlockRadius + \"px\";\r\n        // newWordBlock.style.border = \"grey 1px solid\";\r\n        // newWordBlock.style.background = \"white\";\r\n        newWordBlock.style.position = \"absolute\";\r\n        newWordBlock.style.marginLeft = -game.wordBlockRadius/2 + \"px\";\r\n        newWordBlock.style.marginTop = -game.wordBlockRadius/2 + \"px\";\r\n\r\n        newWordBlock.innerText = obj.character;\r\n        // newWordBlock.style.color = \"black\";\r\n\r\n        document.getElementById(\"game\").appendChild(newWordBlock);\r\n    }\r\n\r\n    addMegaphone(obj) {\r\n        let newMegaphone = document.createElement(\"div\");\r\n        newMegaphone.id = obj.id;\r\n        newMegaphone.className = \"megaphone\";\r\n        newMegaphone.style.height = game.megaphoneRadius + \"px\";\r\n        newMegaphone.style.width = game.megaphoneRadius + \"px\";\r\n        newMegaphone.style.position = \"absolute\";\r\n        newMegaphone.style.marginLeft = -game.megaphoneRadius/2 + \"px\";\r\n        newMegaphone.style.marginTop = -game.megaphoneRadius/2 + \"px\";\r\n\r\n        newMegaphone.innerText = \"📢\";\r\n\r\n        let megaphoneScreen = document.createElement(\"div\");\r\n        megaphoneScreen.className = \"megaphone-screen\";\r\n\r\n        let megaphoneInput = document.createElement(\"input\");\r\n        megaphoneInput.className = \"megaphone-message\";\r\n        megaphoneInput.type = \"text\";\r\n        megaphoneInput.placeholder = \"Your message\";\r\n        megaphoneInput.maxLength = 50;\r\n\r\n        let megaphoneButton = document.createElement(\"button\");\r\n        megaphoneButton.className = \"magephone-button\";\r\n        megaphoneButton.innerText = \"Broadcast\";\r\n\r\n        megaphoneButton.addEventListener(\"click\", () => {\r\n            client.sendInput(\"broadcast:\"+obj.id+\":\"+megaphoneInput.value);\r\n        });\r\n\r\n        megaphoneScreen.appendChild(megaphoneInput);\r\n        megaphoneScreen.appendChild(megaphoneButton);\r\n\r\n        newMegaphone.appendChild(megaphoneScreen);\r\n\r\n        document.getElementById(\"game\").appendChild(newMegaphone);\r\n    }\r\n\r\n\r\n    draw(t, dt) {\r\n        super.draw(t, dt);\r\n\r\n        if (!this.isReady) return;\r\n\r\n        if (!clientPlayer) {\r\n            clientPlayer = game.world.queryObject({playerId: game.playerId, instanceType: Player});\r\n            return;\r\n        }\r\n\r\n        game.world.forEachObject((id, obj) => {            \r\n\r\n            if (obj instanceof Player) {\r\n                if (obj.playerId == clientPlayer.playerId) {\r\n                    this.updateClientPlayer(document.getElementById(id + \"_\" + clientPlayer.playerId), obj);\r\n                } else {\r\n\r\n                    if (obj.emote) {\r\n                        document.getElementById(id + \"_\" + obj.playerId).getElementsByClassName(\"emote\")[0].innerText = obj.emote;\r\n                    }\r\n\r\n                    this.updateOtherObject(document.getElementById(id + \"_\" + obj.playerId), obj, document.getElementById(clientPlayer.id + \"_\" + clientPlayer.playerId), clientPlayer);\r\n                }\r\n                \r\n            } else if (obj instanceof Flag) {\r\n                document.getElementById(id).style.background = obj.color;\r\n\r\n                this.updateOtherObject(document.getElementById(id), obj, document.getElementById(clientPlayer.id + \"_\" + clientPlayer.playerId), clientPlayer);\r\n            \r\n            } else if (obj instanceof WordBlock) {\r\n                document.getElementById(id).innerText = obj.character;\r\n\r\n                this.updateOtherObject(document.getElementById(id), obj, document.getElementById(clientPlayer.id + \"_\" + clientPlayer.playerId), clientPlayer);\r\n            \r\n            } else if (obj instanceof Megaphone) {\r\n                if (game.distance(clientPlayer, obj) <= game.megaphoneRadius) document.getElementById(id).getElementsByClassName(\"megaphone-screen\")[0].style.display = \"block\";\r\n                else document.getElementById(id).getElementsByClassName(\"megaphone-screen\")[0].style.display = \"none\";\r\n\r\n                if (obj.isBroadcasting != 0) {\r\n                    document.getElementById(\"broadcast\").innerText = obj.message;\r\n                    document.getElementById(\"broadcast\").style.display = \"block\";\r\n                }\r\n                else document.getElementById(\"broadcast\").style.display = \"none\";\r\n\r\n                this.updateOtherObject(document.getElementById(id), obj, document.getElementById(clientPlayer.id + \"_\" + clientPlayer.playerId), clientPlayer);\r\n            }\r\n            \r\n        });\r\n\r\n    }\r\n\r\n    // draw current view by moving the map unless at the edges (scrolling effect)\r\n    updateClientPlayer(el, obj) {\r\n\r\n        if (obj.emote) {\r\n            el.getElementsByClassName(\"emote\")[0].innerText = obj.emote;\r\n        }\r\n\r\n        var map = document.getElementById(\"map\");\r\n\r\n        if (!obj.room && (!obj.position.x || !obj.position.y)) {\r\n            console.log(\"Room\" + obj.room + \" x \" + obj.position.x + \" y \" + obj.position.y); \r\n            map.style.top = \"0px\";\r\n            map.style.left = \"0px\";\r\n            el.style.top = game.screenHeight/2 + \"px\";\r\n            el.style.left = game.screenWidth/2 + \"px\";\r\n            obj.position.x = game.screenWidth/2;\r\n            obj.position.y = game.screenHeight/2;\r\n            return;\r\n        }\r\n\r\n        map.src = \".\" + obj.room + \".png\";\r\n        map.style.width = MAPS[obj.room].width + \"px\";\r\n        map.style.height = MAPS[obj.room].height + \"px\";\r\n\r\n\r\n        if (obj.position.x >= MAPS[obj.room].width-game.screenWidth/2) {\r\n            el.style.left = game.screenWidth - (MAPS[obj.room].width - obj.position.x) + \"px\";\r\n        } else if (obj.position.x <= game.screenWidth/2) {\r\n            el.style.left = obj.position.x + \"px\";\r\n        } else {\r\n            map.style.left = \"-\" + (obj.position.x - game.screenWidth/2) + \"px\";\r\n        }\r\n\r\n        if (obj.position.y >= MAPS[obj.room].height-game.screenHeight/2) {\r\n            el.style.top = game.screenHeight - (MAPS[obj.room].height - obj.position.y) + \"px\";\r\n        } else if (obj.position.y <= game.screenHeight/2) {\r\n            el.style.top = obj.position.y + \"px\";\r\n        } else {\r\n            map.style.top = \"-\" + (obj.position.y - game.screenHeight/2) + \"px\";\r\n        }\r\n    }\r\n\r\n    // draw other objects relative to the client's character\r\n    updateOtherObject(el, obj, clientEl, clientObj) {\r\n\r\n        var y = obj.position.y - clientObj.position.y + parseInt(clientEl.style.top.slice(0,-2));\r\n        var x = obj.position.x - clientObj.position.x + parseInt(clientEl.style.left.slice(0,-2));\r\n\r\n        el.style.top = y  + 'px';\r\n        el.style.left = x + 'px';\r\n    }\r\n}"],"file":"WesttownRenderer.js"}